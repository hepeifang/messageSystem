jBud.define("message/data",["socket.io"],function(a,b,c){var i,d=a("socket.io"),e="http://chat.xuan.news.cn/api",f="http://chat.xuan.news.cn:80/",g="http://tmisc.home.news.cn/chat/css",h={urls:{isLogin:e+"/checkLoginStatus.do",userInfo:e+"/userInfo.do",chat:e+"/chatInfo.do",upload:e+"/uploadFile.do",swfupload:e+"/swfupload.swf"},styles:{base:g+"/message.main.css",faces:g+"/faces/",skins:g+"/skins/"},recent:{max:15},talk:{max:50},text:{max:1e3},faces:["\u50b2\u6162","\u767d\u773c","\u95ed\u5634","\u5472\u7259","\u5927\u54ed","\u5f97\u610f","\u8c03\u76ae","\u53d1\u5446","\u53d1\u6012","\u5c34\u5c2c","\u5bb3\u7f9e","\u60ca\u8bb6","\u53ef\u7231","\u9177","\u51b7\u6c57","\u6d41\u6cea","\u96be\u8fc7","\u6487\u5634","\u8272","\u7761\u89c9","\u5077\u7b11","\u5410","\u5fae\u7b11","\u6293\u72c2"],skins:["skin001","skin002","skin003","skin004","skin005"]};c.exports={isReconnect:!1,getStyleBase:function(){return h.styles.base},getSkinDefault:function(){return h.skins[1]},getSkinPath:function(){return h.styles.skins},getRecent:function(a){return"undefined"==typeof a?h.recent:h.recent[a]},getTalk:function(a){return"undefined"==typeof a?h.talk:h.talk[a]},getUpload:function(){return h.urls.upload},getSWFUpload:function(){return h.urls.swfupload},getFaceNames:function(){return h.faces},getFace:function(){return h.styles.faces},getText:function(a){return"undefined"==typeof a?h.talk:h.text[a]},connect:function(){return i||(i=d.connect(f,{reconnect:!1})),this.isReconnect&&i&&("function"==typeof i.socket.reconnect&&i.socket.reconnect(),this.isReconnect=!1),i},disconnect:function(){i&&(i.removeAllListeners(),i.disconnect()),this.isReconnect=!0},clear:function(){this.disconnect(),delete i},queryIsLogin:function(a){jBud.jsonp(h.urls.isLogin,function(b){jBud.isFunction(a)&&a(200==b.code,b)})},queryLogin:function(a,b){var c={userId:void 0},d=this.connect();jBud.extend(c,a),d.emit("userOnLine",c,function(a){jBud.isFunction(b)&&b(a.flag,a)})},queryRecent:function(a,b){var c={method:"getRecentContacts",userId:void 0};jBud.extend(c,a),jBud.jsonp(h.urls.userInfo,c,function(a){jBud.isFunction(b)&&b(200==a.code,a)})},queryFriend:function(a,b){var c={method:"friendsInfo",userId:void 0};jBud.extend(c,a),jBud.jsonp(h.urls.userInfo,c,function(a){jBud.isFunction(b)&&b(200==a.code,a)})},queryFriendInfo:function(a,b){var c={method:"nickNameInfo",userId:void 0};jBud.extend(c,a),jBud.jsonp(h.urls.userInfo,c,function(a){jBud.isFunction(b)&&b(200==a.code,a)})},queryTalk:function(a,b){var c={method:"getAllGroup",userId:void 0};jBud.extend(c,a),jBud.jsonp(h.urls.userInfo,c,function(a){jBud.isFunction(b)&&b(200==a.code,a)})},queryOfflineMessage:function(a,b){var c={method:"getOutlineCnt",userId:void 0};jBud.extend(c,a),jBud.jsonp(h.urls.chat,c,function(a){jBud.isFunction(b)&&b(200==a.code,a)})},queryTalkMember:function(a,b){var c={method:"groupMemberInfo",g_id:void 0};jBud.extend(c,a),jBud.jsonp(h.urls.userInfo,c,function(a){jBud.isFunction(b)&&b(200==a.code,a)})},queryHistoryMessageFriend:function(a,b){var c={method:"chat",userId:void 0,t_id:void 0,pageNum:void 0};jBud.extend(c,a),"undefined"==typeof c.pageNum&&delete c.pageNum,jBud.jsonp(h.urls.chat,c,function(a){jBud.isFunction(b)&&b(200==a.code,a)})},queryHistoryMessageTalk:function(a,b){var c={method:"chatGid",g_id:void 0,pageNum:void 0};jBud.extend(c,a),"undefined"==typeof c.pageNum&&delete c.pageNum,jBud.jsonp(h.urls.chat,c,function(a){jBud.isFunction(b)&&b(200==a.code,a)})},querySkin:function(a,b){var c={method:"getSkin",userId:void 0};jBud.extend(c,a),jBud.jsonp(h.urls.userInfo,c,function(a){jBud.isFunction(b)&&b(200==a.code,a)})},pushSkin:function(a,b){var c={method:"setSkin",userId:void 0,skinValue:void 0};jBud.extend(c,a),jBud.jsonp(h.urls.userInfo,c,function(a){jBud.isFunction(b)&&b(200==a.code,a)})},querySkinList:function(a){var b={skins:h.skins,path:this.getSkinPath()};jBud.isFunction(a)&&a(b)},on:function(a,b){var c=this.connect();c.on(a,function(a){jBud.isFunction(b)&&b(a)})},onFriendMessage:function(a){this.on("msg_show_persion",a)},onTalkMessage:function(a){this.on("msg_show_public",a)},onOffline:function(a){this.on("disconnect",a)},push:function(a,b,c){var d=this.connect();d.emit(a,b,function(a){jBud.isFunction(c)&&c(a)})},pushFriendMessage:function(a,b){var c={userId:void 0,toId:void 0,state:2,context:void 0};jBud.extend(c,a),this.push("send",c,b)},pushTalkMessage:function(a,b){var c={g_id:void 0,send_id:void 0,state:2,context:void 0};jBud.extend(c,a),this.push("sendGroup",c,b)},pushClearOfflineMessage:function(a,b){var c={send_id:void 0,type:-1,d_id:void 0};jBud.extend(c,a),this.push("offlineDel",c,b)},pushTalkCreate:function(a,b){var c={g_id:jBud.uuid(),send_id:void 0,state:3,title:void 0,join_ids:void 0};jBud.extend(c,a),this.push("joinGroup",c,b)},pushTalkJoin:function(a,b){var c={g_id:void 0,send_id:void 0,state:4,join_ids:void 0};jBud.extend(c,a),this.push("joinGroup",c,b)},pushTalkUpdate:function(a,b){var c={g_id:void 0,send_id:void 0,state:5,title:void 0};jBud.extend(c,a),this.push("joinGroup",c,b)},pushTalkQuit:function(a,b){var c={g_id:void 0,userId:void 0,exitId:void 0,state:6};jBud.extend(c,a),this.push("exitGroup",c,b)}}});